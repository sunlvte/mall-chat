<html>
  <head>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <link href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="/socket.io/socket.io.js"></script>
    <style lang="less">
ul li {
  list-style-type: none;
}
    </style>
  </head>
  <body>
    <div class="container">
       <h1 class="">Hello Koa</h1>

       <ul class="ul">
         <li class="left">aaaaaaaaaa</li>
       </ul>

      <div>
        <input type="text" class="form-control" id="input">
      </div>
    </div>
    <script>
(function() {
  const socket = io('/b',{
    query: {
      _id: '5abcd2e39618a1352373c0a8',
      id: '5abcd2e39618a1352373c0a8',
      token: 'alJO2V99Bw',
    }
  });
  const idata = {};

  idata.uid = +new Date();
  socket.emit('service identification', idata);

  $('#input').on('keyup', function(e) {
    if (e.keyCode !== 13) {
      return;
    }

    const message = $('#input').val();

    idata.msg = message;

    socket.emit('replay message', idata);
  });

  socket.on('add side', data => {
    console.log(data.to);
    idata.to = data.to;
  });
  socket.on('destory', data => {
    console.log('destory');
    socket.destroy();
  });
  socket.on('new message', (data) => {
    $('.ul').append('<li>'+data.msg+'</li>');
  });

})();
    </script>
  </body>
</html>
